"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[310],{3905:function(t,n,e){e.d(n,{Zo:function(){return o},kt:function(){return m}});var a=e(7294);function i(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function r(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,a)}return e}function l(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?r(Object(e),!0).forEach((function(n){i(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function h(t,n){if(null==t)return{};var e,a,i=function(t,n){if(null==t)return{};var e,a,i={},r=Object.keys(t);for(a=0;a<r.length;a++)e=r[a],n.indexOf(e)>=0||(i[e]=t[e]);return i}(t,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)e=r[a],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(i[e]=t[e])}return i}var p=a.createContext({}),g=function(t){var n=a.useContext(p),e=n;return t&&(e="function"==typeof t?t(n):l(l({},n),t)),e},o=function(t){var n=g(t.components);return a.createElement(p.Provider,{value:n},t.children)},c={inlineCode:"code",wrapper:function(t){var n=t.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(t,n){var e=t.components,i=t.mdxType,r=t.originalType,p=t.parentName,o=h(t,["components","mdxType","originalType","parentName"]),d=g(e),m=i,k=d["".concat(p,".").concat(m)]||d[m]||c[m]||r;return e?a.createElement(k,l(l({ref:n},o),{},{components:e})):a.createElement(k,l({ref:n},o))}));function m(t,n){var e=arguments,i=n&&n.mdxType;if("string"==typeof t||i){var r=e.length,l=new Array(r);l[0]=d;var h={};for(var p in n)hasOwnProperty.call(n,p)&&(h[p]=n[p]);h.originalType=t,h.mdxType="string"==typeof t?t:i,l[1]=h;for(var g=2;g<r;g++)l[g]=e[g];return a.createElement.apply(null,l)}return a.createElement.apply(null,e)}d.displayName="MDXCreateElement"},2813:function(t,n,e){e.r(n),e.d(n,{frontMatter:function(){return h},contentTitle:function(){return p},metadata:function(){return g},assets:function(){return o},toc:function(){return c},default:function(){return m}});var a=e(7462),i=e(3366),r=(e(7294),e(3905)),l=["components"],h={},p="B\xe0i 6: Gi\u1edbi thi\u1ec7u v\u1ec1 Pandas (ti\u1ebfp theo)",g={unversionedId:"python/pandas_2",id:"python/pandas_2",title:"B\xe0i 6: Gi\u1edbi thi\u1ec7u v\u1ec1 Pandas (ti\u1ebfp theo)",description:"I. T\u1ed4NG QUAN",source:"@site/../docs/tutorial/python/08.pandas_2.md",sourceDirName:"python",slug:"/python/pandas_2",permalink:"/tutorial/python/pandas_2",tags:[],version:"current",sidebarPosition:8,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"B\xe0i 5: Gi\u1edbi thi\u1ec7u v\u1ec1 Pandas",permalink:"/tutorial/python/pandas"},next:{title:"B\xe0i 7: Tr\u1ef1c quan ho\xe1 d\u1eef li\u1ec7u v\u1edbi Matplotlib v\xe0 Seaborn",permalink:"/tutorial/python/visualization"}},o={},c=[{value:"I. T\u1ed4NG QUAN",id:"i-t\u1ed5ng-quan",level:2},{value:"II. C\xc1C H\xc0M C\u01a0 B\u1ea2N",id:"ii-c\xe1c-h\xe0m-c\u01a1-b\u1ea3n",level:2},{value:"1. Indexing",id:"1-indexing",level:3},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: L\u1ea5y gi\xe1 tr\u1ecb \u1edf h\xe0ng th\u1ee9 2 c\u1ed9t <code>total_bill</code> (10.34) trong <code>tips_df</code>",id:"th\u1ef1c-h\xe0nh-l\u1ea5y-gi\xe1-tr\u1ecb-\u1edf-h\xe0ng-th\u1ee9-2-c\u1ed9t-total_bill-1034-trong-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: L\u1ea5y DataFrame d\u01b0\u1edbi \u0111\xe2y t\u1eeb <code>tips_df</code>:",id:"th\u1ef1c-h\xe0nh-l\u1ea5y-dataframe-d\u01b0\u1edbi-\u0111\xe2y-t\u1eeb-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: L\u1ea5y h\u1ebft th\xf4ng tin c\u1ee7a b\u1ea3ng ghi \u0111\u1ea7u ti\xean trong <code>tips_df</code>",id:"th\u1ef1c-h\xe0nh-l\u1ea5y-h\u1ebft-th\xf4ng-tin-c\u1ee7a-b\u1ea3ng-ghi-\u0111\u1ea7u-ti\xean-trong-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: L\u1ea5y t\u1ea5t c\u1ea3 c\xe1c th\xf4ng tin c\u1ed9t <code>total_bill</code> trong <code>tips_df</code> v\xe0 \xe9p \u0111\u1ecbnh d\u1ea1ng v\u1ec1 DataFrame.",id:"th\u1ef1c-h\xe0nh-l\u1ea5y-t\u1ea5t-c\u1ea3-c\xe1c-th\xf4ng-tin-c\u1ed9t-total_bill-trong-tips_df-v\xe0-\xe9p-\u0111\u1ecbnh-d\u1ea1ng-v\u1ec1-dataframe",level:4},{value:"<strong>B\xe0i t\u1eadp</strong>: L\u1ea5y DataFrame d\u01b0\u1edbi \u0111\xe2y trong <code>tips_df</code>.",id:"b\xe0i-t\u1eadp-l\u1ea5y-dataframe-d\u01b0\u1edbi-\u0111\xe2y-trong-tips_df",level:4},{value:"<strong>B\xe0i t\u1eadp</strong>: L\u1ea5y 5 d\xf2ng \u0111\u1ea7u c\u1ee7a 2 c\u1ed9t <code>sex</code> v\xe0 <code>total_bill</code> trong <code>tips_df</code>.",id:"b\xe0i-t\u1eadp-l\u1ea5y-5-d\xf2ng-\u0111\u1ea7u-c\u1ee7a-2-c\u1ed9t-sex-v\xe0-total_bill-trong-tips_df",level:4},{value:"2. Masking/Filtering",id:"2-maskingfiltering",level:3},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c th\xf4ng tin c\u1ee7a nh\u1eefng kh\xe1c h\xe0ng l\xe0 n\u1eef trong <code>tips_df</code>",id:"th\u1ef1c-h\xe0nh-l\u1ecdc-t\u1ea5t-c\u1ea3-c\xe1c-th\xf4ng-tin-c\u1ee7a-nh\u1eefng-kh\xe1c-h\xe0ng-l\xe0-n\u1eef-trong-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c th\xf4ng tin c\u1ee7a nh\u1eefng kh\xe1c h\xe0ng l\xe0 n\u1eef c\xf3 h\xfat thu\u1ed1c trong <code>tips_df</code>",id:"th\u1ef1c-h\xe0nh-l\u1ecdc-t\u1ea5t-c\u1ea3-c\xe1c-th\xf4ng-tin-c\u1ee7a-nh\u1eefng-kh\xe1c-h\xe0ng-l\xe0-n\u1eef-c\xf3-h\xfat-thu\u1ed1c-trong-tips_df",level:4},{value:"<strong>B\xe0i t\u1eadp</strong>:",id:"b\xe0i-t\u1eadp",level:4},{value:"<strong>B\xe0i gi\u1ea3i</strong>:",id:"b\xe0i-gi\u1ea3i",level:4},{value:"3. T\u1ed5ng h\u1ee3p d\u1eef li\u1ec7u (Aggregation)",id:"3-t\u1ed5ng-h\u1ee3p-d\u1eef-li\u1ec7u-aggregation",level:3},{value:"3.1 Groupby()",id:"31-groupby",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: T\xednh trung b\xecnh s\u1ed1 ti\u1ec1n m\u1ed7i gi\u1edbi t\xednh tr\u1ea3 khi \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong <code>tips_df</code>.",id:"th\u1ef1c-h\xe0nh-t\xednh-trung-b\xecnh-s\u1ed1-ti\u1ec1n-m\u1ed7i-gi\u1edbi-t\xednh-tr\u1ea3-khi-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: T\xednh s\u1ed1 ti\u1ec1n l\u1edbn nh\u1ea5t, nh\u1ecf nh\u1ea5t v\xe0 trung b\xecnh ho\xe1 \u0111\u01a1n v\xe0 s\u1ed1 ti\u1ec1n tips m\u1ed7i gi\u1edbi t\xednh chi ra cho 1 b\u1eefa \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong <code>tips_df</code>.",id:"th\u1ef1c-h\xe0nh-t\xednh-s\u1ed1-ti\u1ec1n-l\u1edbn-nh\u1ea5t-nh\u1ecf-nh\u1ea5t-v\xe0-trung-b\xecnh-ho\xe1-\u0111\u01a1n-v\xe0-s\u1ed1-ti\u1ec1n-tips-m\u1ed7i-gi\u1edbi-t\xednh-chi-ra-cho-1-b\u1eefa-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: T\xednh s\u1ed1 ti\u1ec1n trung b\xecnh trong ho\xe1 \u0111\u01a1n v\xe0 tips m\u1ed7i gi\u1edbi t\xednh khi c\xf3 h\xfat thu\u1ed1c v\xe0 kh\xf4ng h\xfat thu\u1ed1c chi ra cho 1 b\u1eefa \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong <code>tips_df</code>.",id:"th\u1ef1c-h\xe0nh-t\xednh-s\u1ed1-ti\u1ec1n-trung-b\xecnh-trong-ho\xe1-\u0111\u01a1n-v\xe0-tips-m\u1ed7i-gi\u1edbi-t\xednh-khi-c\xf3-h\xfat-thu\u1ed1c-v\xe0-kh\xf4ng-h\xfat-thu\u1ed1c-chi-ra-cho-1-b\u1eefa-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: T\xednh s\u1ed1 ti\u1ec1n trung b\xecnh trong ho\xe1 \u0111\u01a1n v\xe0 tips m\u1ed7i gi\u1edbi t\xednh khi c\xf3 h\xfat thu\u1ed1c v\xe0 kh\xf4ng h\xfat thu\u1ed1c chi ra cho 1 b\u1eefa \u0103n t\u1ed1i t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong <code>tips_df</code>.",id:"th\u1ef1c-h\xe0nh-t\xednh-s\u1ed1-ti\u1ec1n-trung-b\xecnh-trong-ho\xe1-\u0111\u01a1n-v\xe0-tips-m\u1ed7i-gi\u1edbi-t\xednh-khi-c\xf3-h\xfat-thu\u1ed1c-v\xe0-kh\xf4ng-h\xfat-thu\u1ed1c-chi-ra-cho-1-b\u1eefa-\u0103n-t\u1ed1i-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df",level:4},{value:"<strong>B\xe0i t\u1eadp</strong>:",id:"b\xe0i-t\u1eadp-1",level:4},{value:"<strong>B\xe0i gi\u1ea3i</strong>:",id:"b\xe0i-gi\u1ea3i-1",level:4},{value:"3.2 Pivot",id:"32-pivot",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: T\xednh trung b\xecnh s\u1ed1 ti\u1ec1n m\u1ed7i gi\u1edbi t\xednh tr\u1ea3 khi \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong <code>tips_df</code>.",id:"th\u1ef1c-h\xe0nh-t\xednh-trung-b\xecnh-s\u1ed1-ti\u1ec1n-m\u1ed7i-gi\u1edbi-t\xednh-tr\u1ea3-khi-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df-1",level:4},{value:"<strong>Th\u1ef1c h\xe0nh</strong>: T\xednh t\u1ed5ng s\u1ed1 ti\u1ec1n nh\xe0 h\xe0ng thu \u0111\u01b0\u1ee3c kh\xf4ng k\u1ec3 tips c\xe1c ng\xe0y trong tu\u1ea7n theo b\u1eefa \u0103n \u0111\u01b0\u1ee3c th\u1ed1ng k\xea trong <code>tips_df</code>.",id:"th\u1ef1c-h\xe0nh-t\xednh-t\u1ed5ng-s\u1ed1-ti\u1ec1n-nh\xe0-h\xe0ng-thu-\u0111\u01b0\u1ee3c-kh\xf4ng-k\u1ec3-tips-c\xe1c-ng\xe0y-trong-tu\u1ea7n-theo-b\u1eefa-\u0103n-\u0111\u01b0\u1ee3c-th\u1ed1ng-k\xea-trong-tips_df",level:4},{value:"4. H\u1ee3p nh\u1ea5t d\u1eef li\u1ec7u (Merge, Concat)",id:"4-h\u1ee3p-nh\u1ea5t-d\u1eef-li\u1ec7u-merge-concat",level:3},{value:"4.1 Merge",id:"41-merge",level:4},{value:"4.2 Concat",id:"42-concat",level:4}],d={toc:c};function m(t){var n=t.components,e=(0,i.Z)(t,l);return(0,r.kt)("wrapper",(0,a.Z)({},d,e,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"b\xe0i-6-gi\u1edbi-thi\u1ec7u-v\u1ec1-pandas-ti\u1ebfp-theo"},"B\xe0i 6: Gi\u1edbi thi\u1ec7u v\u1ec1 Pandas (ti\u1ebfp theo)"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ed/Pandas_logo.svg/1200px-Pandas_logo.svg.png",alt:null})),(0,r.kt)("h2",{id:"i-t\u1ed5ng-quan"},"I. T\u1ed4NG QUAN"),(0,r.kt)("p",null,"\u0110\u1ec3 hi\u1ec3n th\u1ecb h\u1ebft c\xe1c d\xf2ng v\xe0 c\xe1c c\u1ed9t c\u1ee7a 1 DataFrame ho\u1eb7c 1 Series, ta c\xf3 th\u1ec3 t\u1eadn d\u1ee5ng c\xe2u l\u1ec7nh d\u01b0\u1edbi \u0111\xe2y:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"pd.options.display.max_rows = \x1dNone \npd.options.display.max_columns = None\n")),(0,r.kt)("p",null,"ho\u1eb7c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"pd.set_option('display.max_rows', None)\npd.set_option('display.max_columns', None)\n")),(0,r.kt)("p",null,"\u0110\u1ec3 thu\u1eadn ti\u1ec7n cho vi\u1ec7c ph\xe2n t\xedch d\u1eef li\u1ec7u th\xf4ng qua c\xe1c h\xe0m c\u01a1 b\u1ea3n Pandas h\u1ed7 tr\u1ee3, ta s\u1eed d\u1ee5ng d\u1eef li\u1ec7u ",(0,r.kt)("inlineCode",{parentName:"p"},"tips")," trong bu\u1ed5i tr\u01b0\u1edbc, c\xf3 format nh\u01b0 sau:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"total_bill"),(0,r.kt)("th",{parentName:"tr",align:"right"},"tip"),(0,r.kt)("th",{parentName:"tr",align:"left"},"sex"),(0,r.kt)("th",{parentName:"tr",align:"left"},"smoker"),(0,r.kt)("th",{parentName:"tr",align:"left"},"day"),(0,r.kt)("th",{parentName:"tr",align:"left"},"time"),(0,r.kt)("th",{parentName:"tr",align:"right"},"size"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"0"),(0,r.kt)("td",{parentName:"tr",align:"right"},"16.99"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.01"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Female"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner"),(0,r.kt)("td",{parentName:"tr",align:"right"},"2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"1"),(0,r.kt)("td",{parentName:"tr",align:"right"},"10.34"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.66"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"2"),(0,r.kt)("td",{parentName:"tr",align:"right"},"21.01"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.5"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3"),(0,r.kt)("td",{parentName:"tr",align:"right"},"23.68"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.31"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner"),(0,r.kt)("td",{parentName:"tr",align:"right"},"2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"4"),(0,r.kt)("td",{parentName:"tr",align:"right"},"24.59"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.61"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Female"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner"),(0,r.kt)("td",{parentName:"tr",align:"right"},"4")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import pandas as pd # import th\u01b0 vi\u1ec7n pandas \u0111\u1ec3 ph\xe2n t\xedch d\u1eef li\u1ec7u\nimport seaborn as sns # import th\u01b0 vi\u1ec7n seaborn \u0111\u1ec3 load d\u1eef li\u1ec7u\ntips_df = sns.load_dataset('tips')\n")),(0,r.kt)("h2",{id:"ii-c\xe1c-h\xe0m-c\u01a1-b\u1ea3n"},"II. C\xc1C H\xc0M C\u01a0 B\u1ea2N"),(0,r.kt)("h3",{id:"1-indexing"},"1. Indexing"),(0,r.kt)("p",null,"\u1ede ph\u1ea7n tr\u01b0\u1edbc, ch\xfang ta \u0111\xe3 n\u1eafm \u0111\u01b0\u1ee3c c\xe1ch kh\u1edfi t\u1ea1o 1 DataFrame ho\u1eb7c 1 Series trong Pandas c\u0169ng nh\u01b0 c\xe1ch ta c\xf3 th\u1ec3 \u0111\u1ecdc 1 file t\u1eeb tr\xean m\u1ea1ng v\xe0 trong m\xe1y c\u1ee7a b\u1ea1n."),(0,r.kt)("p",null,"V\u1eady n\u1ebfu mu\u1ed1n truy c\u1eadp v\xe0o 1 ph\u1ea7n t\u1eed c\u1ee5 th\u1ec3 trong DataFrame ho\u1eb7c Series th\xec ta ph\u1ea3i l\xe0m nh\u01b0 th\u1ebf n\xe0o? "),(0,r.kt)("p",null,"\u0110\u1ec3 l\xe0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\xe0y, Pandas c\xf3 h\u1ed7 tr\u1ee3:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[]"),": ch\u1ecdn c\xe1c c\u1ed9t trong DataFrame v\xe0 tr\u1ea3 v\u1ec1 1 Series.")),(0,r.kt)("p",null,"Ch\u1ecdn t\u1ea5t c\u1ea3 c\xe1c d\xf2ng (slicing):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"loc")," (location): ",(0,r.kt)("inlineCode",{parentName:"p"},"df.loc[row_label,col_label]"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"series.loc[row_label]")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"loc")," nh\u1eadn t\xean c\u1ee7a c\xe1c h\xe0ng v\xe0 c\u1ed9t, v\xe0 tr\u1ea3 v\u1ec1 1 Series ho\u1eb7c DataFrame. Ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,r.kt)("inlineCode",{parentName:"p"},"loc")," \u0111\u1ec3 l\u1ea5y to\xe0n b\u1ed9 h\xe0ng ho\u1eb7c c\u1ed9t, c\u0169ng nh\u01b0 c\xe1c ph\u1ea7n nh\u1ecf c\u1ee7a ch\xfang. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"iloc")," (index location): ",(0,r.kt)("inlineCode",{parentName:"p"},"df.iloc[row_index,col_index]"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"series.iloc[row_index]")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"iloc")," nh\u1eadn c\xe1c index c\u1ee7a c\xe1c h\xe0ng v\xe0 c\u1ed9t, v\xe0 tr\u1ea3 v\u1ec1 1 Series ho\u1eb7c DataFrame. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 ",(0,r.kt)("inlineCode",{parentName:"p"},"loc"),", ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,r.kt)("inlineCode",{parentName:"p"},"loc")," \u0111\u1ec3 l\u1ea5y to\xe0n b\u1ed9 h\xe0ng ho\u1eb7c c\u1ed9t, c\u0169ng nh\u01b0 c\xe1c ph\u1ea7n nh\u1ecf c\u1ee7a ch\xfang. "))),(0,r.kt)("p",null,"Ch\u1ecdn 1 cell:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"at"),":  ",(0,r.kt)("inlineCode",{parentName:"p"},"df.at[row_label,col_label]")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"at")," nh\u1eadn t\xean c\u1ee7a c\xe1c h\xe0ng v\xe0 c\u1ed9t, v\xe0 tr\u1ea3 v\u1ec1 m\u1ed9t gi\xe1 tr\u1ecb d\u1eef li\u1ec7u duy nh\u1ea5t.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"iat"),": ",(0,r.kt)("inlineCode",{parentName:"p"},"df.iat[row_index,col_index]")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"iat")," nh\u1eadn index c\u1ee7a c\xe1c h\xe0ng v\xe0 c\u1ed9t, v\xe0 tr\u1ea3 v\u1ec1 m\u1ed9t gi\xe1 tr\u1ecb d\u1eef li\u1ec7u duy nh\u1ea5t."))),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-l\u1ea5y-gi\xe1-tr\u1ecb-\u1edf-h\xe0ng-th\u1ee9-2-c\u1ed9t-total_bill-1034-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": L\u1ea5y gi\xe1 tr\u1ecb \u1edf h\xe0ng th\u1ee9 2 c\u1ed9t ",(0,r.kt)("inlineCode",{parentName:"h4"},"total_bill")," (10.34) trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[1,'total_bill']\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"10.34\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.iloc[1,0]\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"10.34\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.at[1,'total_bill']\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"10.34\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.iat[1,0]\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"10.34\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-l\u1ea5y-dataframe-d\u01b0\u1edbi-\u0111\xe2y-t\u1eeb-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": L\u1ea5y DataFrame d\u01b0\u1edbi \u0111\xe2y t\u1eeb ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"total_bill"),(0,r.kt)("th",{parentName:"tr",align:"right"},"tip"),(0,r.kt)("th",{parentName:"tr",align:"left"},"sex"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"0"),(0,r.kt)("td",{parentName:"tr",align:"right"},"16.99"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.01"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Female")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"1"),(0,r.kt)("td",{parentName:"tr",align:"right"},"10.34"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.66"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"2"),(0,r.kt)("td",{parentName:"tr",align:"right"},"21.01"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.5"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3"),(0,r.kt)("td",{parentName:"tr",align:"right"},"23.68"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.31"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"4"),(0,r.kt)("td",{parentName:"tr",align:"right"},"24.59"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.61"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Female")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"5"),(0,r.kt)("td",{parentName:"tr",align:"right"},"25.29"),(0,r.kt)("td",{parentName:"tr",align:"right"},"4.71"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[:5,:'sex'] # bao g\u1ed3m t\xean c\u1ed9t, h\xe0ng b\u1eaft \u0111\u1ea7u v\xe0 bao g\u1ed3m t\xean c\u1ed9t, h\xe0ng k\u1ebft th\xfac\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.iloc[:6,:3] #bao g\u1ed3m index b\u1eaft \u0111\u1ea7u, kh\xf4ng bao g\u1ed3m index k\u1ebft th\xfac\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-l\u1ea5y-h\u1ebft-th\xf4ng-tin-c\u1ee7a-b\u1ea3ng-ghi-\u0111\u1ea7u-ti\xean-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": L\u1ea5y h\u1ebft th\xf4ng tin c\u1ee7a b\u1ea3ng ghi \u0111\u1ea7u ti\xean trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"left"},"0"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"total_bill"),(0,r.kt)("td",{parentName:"tr",align:"left"},"16.99")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"tip"),(0,r.kt)("td",{parentName:"tr",align:"left"},"1.01")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"sex"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Female")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"smoker"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"day"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"time"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"size"),(0,r.kt)("td",{parentName:"tr",align:"left"},"2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"wow"),(0,r.kt)("td",{parentName:"tr",align:"left"},"nan")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[0,] #tips_df.loc[0] \n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.iloc[0,] #tips_df.iloc[0]\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-l\u1ea5y-t\u1ea5t-c\u1ea3-c\xe1c-th\xf4ng-tin-c\u1ed9t-total_bill-trong-tips_df-v\xe0-\xe9p-\u0111\u1ecbnh-d\u1ea1ng-v\u1ec1-dataframe"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": L\u1ea5y t\u1ea5t c\u1ea3 c\xe1c th\xf4ng tin c\u1ed9t ",(0,r.kt)("inlineCode",{parentName:"h4"},"total_bill")," trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df")," v\xe0 \xe9p \u0111\u1ecbnh d\u1ea1ng v\u1ec1 DataFrame."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df['total_bill'].to_frame() # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"pd.DataFrame(tips_df['total_bill']) # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df[['total_bill']] # c\xe1ch 3\n")),(0,r.kt)("h4",{id:"b\xe0i-t\u1eadp-l\u1ea5y-dataframe-d\u01b0\u1edbi-\u0111\xe2y-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"B\xe0i t\u1eadp"),": L\u1ea5y DataFrame d\u01b0\u1edbi \u0111\xe2y trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"total_bill"),(0,r.kt)("th",{parentName:"tr",align:"right"},"tip"),(0,r.kt)("th",{parentName:"tr",align:"left"},"sex"),(0,r.kt)("th",{parentName:"tr",align:"left"},"smoker"),(0,r.kt)("th",{parentName:"tr",align:"left"},"day"),(0,r.kt)("th",{parentName:"tr",align:"left"},"time"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3"),(0,r.kt)("td",{parentName:"tr",align:"right"},"23.68"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.31"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Male"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"4"),(0,r.kt)("td",{parentName:"tr",align:"right"},"24.59"),(0,r.kt)("td",{parentName:"tr",align:"right"},"3.61"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Female"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sun"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dinner")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[3:4,:'time'] # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.iloc[3:5,:6] # c\xe1ch 2\n")),(0,r.kt)("h4",{id:"b\xe0i-t\u1eadp-l\u1ea5y-5-d\xf2ng-\u0111\u1ea7u-c\u1ee7a-2-c\u1ed9t-sex-v\xe0-total_bill-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"B\xe0i t\u1eadp"),": L\u1ea5y 5 d\xf2ng \u0111\u1ea7u c\u1ee7a 2 c\u1ed9t ",(0,r.kt)("inlineCode",{parentName:"h4"},"sex")," v\xe0 ",(0,r.kt)("inlineCode",{parentName:"h4"},"total_bill")," trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df[['sex','total_bill']].head(5) # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[:4,['sex','total_bill']] # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.iloc[:5,[2,0]] # c\xe1ch 3\n")),(0,r.kt)("h3",{id:"2-maskingfiltering"},"2. Masking/Filtering"),(0,r.kt)("p",null,"Trong th\u1ef1c t\u1ebf, \u0111\u1ed1i v\u1edbi 1 t\u1eadp d\u1eef li\u1ec7u c\xf3 c\u1ea5u tr\xfac, \u0111\xf4i khi ta mu\u1ed1n l\u1ecdc d\u1eef li\u1ec7u theo 1 s\u1ed1 ti\xeau ch\xed nh\u1ea5t \u0111\u1ecbnh nh\u1eb1m \u0111\xe1p \u1ee9ng nhu c\u1ea7u b\xe0i to\xe1n \u0111\u1ec1 ra, v\xed d\u1ee5 ph\xe2n t\xedch t\u1eadp kh\xe1ch h\xe0ng n\u1eef, ph\xe2n t\xedch t\u1eadp kh\xe1ch h\xe0ng V.I.P c\xf3 ho\xe1 \u0111\u01a1n cao h\u01a1n 1 m\u1ee9c nh\u1ea5t \u0111\u1ecbnh, hay t\u1ed5ng h\u1ee3p v\xe0 ch\u1ec9 tr\xedch xu\u1ea5t d\u1eef li\u1ec7u trong 1 kho\u1ea3ng th\u1eddi gian c\u1ea7n \u0111\u1ec3 ph\xe2n t\xedch. \u0110\u1ec3 \u0111\xe1p \u1ee9ng nhu c\u1ea7u tr\xean, Pandas c\xf3 1 s\u1ed1 c\xe1ch ph\u1ed5 bi\u1ebfn nh\u01b0 sau:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"S\u1eed d\u1ee5ng c\u1ea5u tr\xfac ",(0,r.kt)("inlineCode",{parentName:"li"},"df_name.loc[conditions]")),(0,r.kt)("li",{parentName:"ul"},"S\u1eed d\u1ee5ng c\u1ea5u tr\xfac ",(0,r.kt)("inlineCode",{parentName:"li"},"df_name[conditions]")),(0,r.kt)("li",{parentName:"ul"},"S\u1eed d\u1ee5ng h\xe0m ",(0,r.kt)("inlineCode",{parentName:"li"},"query()"),".")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-l\u1ecdc-t\u1ea5t-c\u1ea3-c\xe1c-th\xf4ng-tin-c\u1ee7a-nh\u1eefng-kh\xe1c-h\xe0ng-l\xe0-n\u1eef-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c th\xf4ng tin c\u1ee7a nh\u1eefng kh\xe1c h\xe0ng l\xe0 n\u1eef trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[tips_df['sex'] == 'Female'] # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df[tips_df['sex'] == 'Female'] # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.query(\"sex == 'Female'\") # c\xe1ch 3\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-l\u1ecdc-t\u1ea5t-c\u1ea3-c\xe1c-th\xf4ng-tin-c\u1ee7a-nh\u1eefng-kh\xe1c-h\xe0ng-l\xe0-n\u1eef-c\xf3-h\xfat-thu\u1ed1c-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c th\xf4ng tin c\u1ee7a nh\u1eefng kh\xe1c h\xe0ng l\xe0 n\u1eef c\xf3 h\xfat thu\u1ed1c trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df[(tips_df['sex'] == 'Female') & (tips_df['smoker'] == 'Yes')] # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[(tips_df['sex'] == 'Female') & (tips_df['smoker'] == 'Yes')] # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.query(\"sex == 'Female' & smoker == 'Yes'\") # c\xe1ch 3\n")),(0,r.kt)("h4",{id:"b\xe0i-t\u1eadp"},(0,r.kt)("strong",{parentName:"h4"},"B\xe0i t\u1eadp"),":"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c b\u1ea3n ghi ch\u1ee9a th\xf4ng tin c\u1ee7a kh\xe1ch h\xe0ng \x1dnam c\xf3 t\u1ed5ng ho\xe1 \u0111\u01a1n l\u1edbn h\u01a1n 10."),(0,r.kt)("li",{parentName:"ol"},"L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c b\u1ea3n ghi ch\u1ee9a th\xf4ng tin c\u1ee7a kh\xe1ch h\xe0ng kh\xf4ng h\xfat thu\u1ed1c v\xe0 d\xf9ng su\u1ea5t \u0103n cho 3 ng\u01b0\u1eddi tr\u1edf l\xean."),(0,r.kt)("li",{parentName:"ol"},"L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c b\u1ea3n ghi ch\u1ee9a th\xf4ng tin c\u1ee7a kh\xe1ch h\xe0ng \x1dn\u1eef \u0103n t\u1ed1i t\u1ea1i nh\xe0 h\xe0ng v\xe0o cu\u1ed1i tu\u1ea7n (Th\u1ee9 7, Ch\u1ee7 nh\u1eadt) v\xe0 tip cho nh\xe2n vi\xean t\u1eeb 5 \u0111\xf4 tr\u1edf l\xean.")),(0,r.kt)("h4",{id:"b\xe0i-gi\u1ea3i"},(0,r.kt)("strong",{parentName:"h4"},"B\xe0i gi\u1ea3i"),":"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c b\u1ea3n ghi ch\u1ee9a th\xf4ng tin c\u1ee7a kh\xe1ch h\xe0ng \x1dnam c\xf3 t\u1ed5ng ho\xe1 \u0111\u01a1n l\u1edbn h\u01a1n 10.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"condition1 = (tips_df['sex'] == 'Male') & (tips_df['total_bill'] > 10)\ntips_df[condition1] # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[condition1] # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.query(\"sex == 'Male' & total_bill > 10\") # c\xe1ch 3\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c b\u1ea3n ghi ch\u1ee9a th\xf4ng tin c\u1ee7a kh\xe1ch h\xe0ng kh\xf4ng h\xfat thu\u1ed1c v\xe0 d\xf9ng su\u1ea5t \u0103n cho 3 ng\u01b0\u1eddi tr\u1edf l\xean.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"condition2 = (tips_df['smoker'] == 'No') & (tips_df['size'] >=3)\ntips_df[condition2] # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[condition2] # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.query(\"smoker == 'No' & size >= 3\") # c\xe1ch 3\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"L\u1ecdc t\u1ea5t c\u1ea3 c\xe1c b\u1ea3n ghi ch\u1ee9a th\xf4ng tin c\u1ee7a kh\xe1ch h\xe0ng \x1dn\u1eef \u0103n t\u1ed1i t\u1ea1i nh\xe0 h\xe0ng v\xe0o cu\u1ed1i tu\u1ea7n (Th\u1ee9 7, Ch\u1ee7 nh\u1eadt) v\xe0 tip cho nh\xe2n vi\xean \x1dt\u1eeb 5 \u0111\xf4 tr\u1edf l\xean.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"condition3 = (tips_df['sex'] == \"Female\") & (tips_df['time'] == \"Dinner\") & ((tips_df['day'] == \"Sat\") | (tips_df['day'] == \"Sun\")) & (tips_df['tip'] >=5)\ntips_df[condition3] # c\xe1ch 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.loc[condition3] # c\xe1ch 2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.query(\"(sex == 'Female') & (time == 'Dinner') & ((day == 'Sat') | (day == 'Sun')) & (tip >= 5)\") # c\xe1ch 3\n")),(0,r.kt)("h3",{id:"3-t\u1ed5ng-h\u1ee3p-d\u1eef-li\u1ec7u-aggregation"},"3. T\u1ed5ng h\u1ee3p d\u1eef li\u1ec7u (Aggregation)"),(0,r.kt)("h4",{id:"31-groupby"},"3.1 Groupby()"),(0,r.kt)("p",null,"Trong Python, ",(0,r.kt)("inlineCode",{parentName:"p"},"groupby()")," l\xe0 m\u1ed9t h\xe0m linh ho\u1ea1t trong Python cho ph\xe9p b\u1ea1n chia d\u1eef li\u1ec7u th\xe0nh c\xe1c nh\xf3m ri\xeang bi\u1ec7t \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\xe1c ph\xe9p t\xednh nh\u1eb1m ph\xe2n t\xedch t\u1ed1t h\u01a1n, c\u0169ng ho\xe0n to\xe0n t\u01b0\u01a1ng t\u1ef1 nh\u01b0 groupby trong SQL."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"groupby()")," \u0111\u01b0\u1ee3c x\xe2y d\u1ef1ng theo c\u01a1 ch\u1ebf 3 b\u01b0\u1edbc:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Split"),": Chia d\u1eef li\u1ec7u th\xe0nh c\xe1c nh\xf3m d\u1ef1a tr\xean m\u1ed9t s\u1ed1 ti\xeau ch\xed (v\xed d\u1ee5 theo c\u1ed9t ",(0,r.kt)("inlineCode",{parentName:"li"},"x")," trong \u1ea3nh m\xf4 t\u1ea3 \u1edf d\u01b0\u1edbi)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Apply"),": \xc1p d\u1ee5ng m\u1ed9t s\u1ed1 ph\xe9p t\xednh to\xe1n cho t\u1eebng nh\xf3m m\u1ed9t c\xe1ch \u0111\u1ed9c l\u1eadp (v\xed d\u1ee5 t\xednh t\u1ed5ng c\xe1c gi\xe1 tr\u1ecb c\u1ee7a t\u1eebng nh\xf3m trong c\u1ed9t ",(0,r.kt)("inlineCode",{parentName:"li"},"x"),"). B\u01b0\u1edbc n\xe0y c\xf3 th\u1ec3 l\xe0 1 trong c\xe1c thao t\xe1c d\u01b0\u1edbi \u0111\xe2y:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"T\u1ed5ng h\u1ee3p (Aggregation/Reduction): \u0111\u01b0a ra 1 s\u1ed1 ph\xe2n t\xedch th\u1ed1ng k\xea trong m\u1ed9t nh\xf3m nh\u01b0 sum, mean, std, min, max, size, count ... c\u1ee7a nh\xf3m d\u1eef li\u1ec7u."),(0,r.kt)("li",{parentName:"ul"},"Chuy\u1ec3n \u0111\u1ed5i (Transformation): th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 t\xednh to\xe1n nh\xf3m nh\u01b0 chu\u1ea9n ho\xe1, l\u1ea5p \u0111\u1ea7y c\xe1c gi\xe1 tr\u1ecb null ..."),(0,r.kt)("li",{parentName:"ul"},"L\u1ecdc (Filteration): lo\u1ea1i b\u1ecf m\u1ed9t s\u1ed1 nh\xf3m, ..."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Combine"),": K\u1ebft h\u1ee3p c\xe1c k\u1ebft qu\u1ea3 v\xe0o m\u1ed9t c\u1ea5u tr\xfac d\u1eef li\u1ec7u.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://blog.dask.org/images/split-apply-combine.png",alt:null})),(0,r.kt)("p",null,"Pandas h\u1ed7 tr\u1ee3 13 ch\u1ee9c n\u0103ng t\u1ed5ng h\u1ee3p s\u1eed d\u1ee5ng sau ",(0,r.kt)("inlineCode",{parentName:"p"},"groupby()")," sau:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"T\xean h\xe0m"),(0,r.kt)("th",{parentName:"tr",align:null},"\xdd ngh\u0129a"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"mean()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh trung b\xecnh c\u1ee7a c\xe1c nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"sum()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh t\u1ed5ng c\xe1c gi\xe1 tr\u1ecb c\u1ee7a nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"size()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh k\xedch th\u01b0\u1edbc nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"count()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh to\xe1n s\u1ed1 l\u01b0\u1ee3ng nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"std()")),(0,r.kt)("td",{parentName:"tr",align:null},"\u0110\u1ed9 l\u1ec7ch chu\u1ea9n c\u1ee7a c\xe1c nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"var()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh to\xe1n ph\u01b0\u01a1ng sai c\u1ee7a c\xe1c nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"sem()")),(0,r.kt)("td",{parentName:"tr",align:null},"Sai s\u1ed1 chu\u1ea9n c\u1ee7a gi\xe1 tr\u1ecb trung b\xecnh c\u1ee7a c\xe1c nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"describe()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\u1ea1o th\u1ed1ng k\xea m\xf4 t\u1ea3")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"first()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh to\xe1n gi\xe1 tr\u1ecb \u0111\u1ea7u ti\xean c\u1ee7a nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"last()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh gi\xe1 tr\u1ecb cu\u1ed1i c\xf9ng c\u1ee7a nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"nth()")),(0,r.kt)("td",{parentName:"tr",align:null},"L\u1ea5y gi\xe1 tr\u1ecb th\u1ee9 n ho\u1eb7c m\u1ed9t t\u1eadp h\u1ee3p con n\u1ebfu n l\xe0 m\u1ed9t danh s\xe1ch")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"min()")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh to\xe1n gi\xe1 tr\u1ecb nh\u1ecf nh\u1ea5t nh\xf3m")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"max():")),(0,r.kt)("td",{parentName:"tr",align:null},"T\xednh to\xe1n gi\xe1 tr\u1ecb l\u1edbn nh\u1ea5t nh\xf3m")))),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-t\xednh-trung-b\xecnh-s\u1ed1-ti\u1ec1n-m\u1ed7i-gi\u1edbi-t\xednh-tr\u1ea3-khi-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": T\xednh trung b\xecnh s\u1ed1 ti\u1ec1n m\u1ed7i gi\u1edbi t\xednh tr\u1ea3 khi \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.groupby('sex').total_bill.mean() # ri\xeang ho\xe1 \u0111\u01a1n\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df['total_bill_tip'] = tips_df['total_bill'] + tips_df['tip'] #c\u1ea3 ho\xe1 \u0111\u01a1n v\xe0 tips\ntips_df.groupby('sex').total_bill_tip.mean()\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-t\xednh-s\u1ed1-ti\u1ec1n-l\u1edbn-nh\u1ea5t-nh\u1ecf-nh\u1ea5t-v\xe0-trung-b\xecnh-ho\xe1-\u0111\u01a1n-v\xe0-s\u1ed1-ti\u1ec1n-tips-m\u1ed7i-gi\u1edbi-t\xednh-chi-ra-cho-1-b\u1eefa-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": T\xednh s\u1ed1 ti\u1ec1n l\u1edbn nh\u1ea5t, nh\u1ecf nh\u1ea5t v\xe0 trung b\xecnh ho\xe1 \u0111\u01a1n v\xe0 s\u1ed1 ti\u1ec1n tips m\u1ed7i gi\u1edbi t\xednh chi ra cho 1 b\u1eefa \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.groupby('sex').agg({'total_bill':['mean','min','max'],'tip':['mean','min','max']})\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# Ta c\xf3 th\u1ec3 \u0111\u1ed5i t\xean c\u1ed9t b\u1eb1ng c\xe1ch d\u01b0\u1edbi \u0111\xe2y\ntips_df.groupby('sex').agg(mean_total_bill=('total_bill','mean'), mean_total_tip=('tip','mean'))\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-t\xednh-s\u1ed1-ti\u1ec1n-trung-b\xecnh-trong-ho\xe1-\u0111\u01a1n-v\xe0-tips-m\u1ed7i-gi\u1edbi-t\xednh-khi-c\xf3-h\xfat-thu\u1ed1c-v\xe0-kh\xf4ng-h\xfat-thu\u1ed1c-chi-ra-cho-1-b\u1eefa-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": T\xednh s\u1ed1 ti\u1ec1n trung b\xecnh trong ho\xe1 \u0111\u01a1n v\xe0 tips m\u1ed7i gi\u1edbi t\xednh khi c\xf3 h\xfat thu\u1ed1c v\xe0 kh\xf4ng h\xfat thu\u1ed1c chi ra cho 1 b\u1eefa \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.groupby(['sex','smoker'])[['total_bill','tip']].mean()\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-t\xednh-s\u1ed1-ti\u1ec1n-trung-b\xecnh-trong-ho\xe1-\u0111\u01a1n-v\xe0-tips-m\u1ed7i-gi\u1edbi-t\xednh-khi-c\xf3-h\xfat-thu\u1ed1c-v\xe0-kh\xf4ng-h\xfat-thu\u1ed1c-chi-ra-cho-1-b\u1eefa-\u0103n-t\u1ed1i-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": T\xednh s\u1ed1 ti\u1ec1n trung b\xecnh trong ho\xe1 \u0111\u01a1n v\xe0 tips m\u1ed7i gi\u1edbi t\xednh khi c\xf3 h\xfat thu\u1ed1c v\xe0 kh\xf4ng h\xfat thu\u1ed1c chi ra cho 1 b\u1eefa \u0103n t\u1ed1i t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df[tips_df['time'] == 'Dinner'].groupby(['sex','smoker'])[['total_bill','tip']].mean()\n")),(0,r.kt)("h4",{id:"b\xe0i-t\u1eadp-1"},(0,r.kt)("strong",{parentName:"h4"},"B\xe0i t\u1eadp"),":"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"T\u1ed5ng doanh thu c\u1ee7a nh\xe0 h\xe0ng th\u1eddi gian d\xf9ng b\u1eefa c\u1ee7a kh\xe1ch h\xe0ng theo s\u1ed1 li\u1ec7u th\u1ed1ng k\u1ebf trong ",(0,r.kt)("inlineCode",{parentName:"li"},"tips_df"),"."),(0,r.kt)("li",{parentName:"ol"},"T\u1ed5ng doanh thu kh\xf4ng t\xednh tips c\u1ee7a nh\xe0 h\xe0ng theo th\u1eddi gian d\xf9ng b\u1eefa v\u1edbi ri\xeang kh\xe1ch h\xe0ng kh\xf4ng h\xfat thu\u1ed1c v\xe0o cu\u1ed1i tu\u1ea7n (th\u1ee9 7, ch\u1ee7 nh\u1eadt).")),(0,r.kt)("h4",{id:"b\xe0i-gi\u1ea3i-1"},(0,r.kt)("strong",{parentName:"h4"},"B\xe0i gi\u1ea3i"),":"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"T\u1ed5ng doanh thu c\u1ee7a nh\xe0 h\xe0ng th\u1eddi gian d\xf9ng b\u1eefa c\u1ee7a kh\xe1ch h\xe0ng theo s\u1ed1 li\u1ec7u th\u1ed1ng k\u1ebf trong ",(0,r.kt)("inlineCode",{parentName:"li"},"tips_df"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.groupby('time').total_bill_tip.sum()\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"T\u1ed5ng doanh thu kh\xf4ng t\xednh tips c\u1ee7a nh\xe0 h\xe0ng theo th\u1eddi gian d\xf9ng b\u1eefa v\u1edbi ri\xeang kh\xe1ch h\xe0ng kh\xf4ng h\xfat thu\u1ed1c v\xe0o cu\u1ed1i tu\u1ea7n (th\u1ee9 7, ch\u1ee7 nh\u1eadt).")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df[(tips_df['smoker'] == 'No') & ((tips_df['day'] == 'Sat') | (tips_df['day'] == 'Sun'))].groupby('time').total_bill.sum()\n")),(0,r.kt)("h4",{id:"32-pivot"},"3.2 Pivot"),(0,r.kt)("p",null,"N\u1ebfu nh\u01b0 b\u1ea1n \u0111\xe3 t\u1eebng l\xe0m vi\u1ec7c v\u1edbi Excel ch\u1eafc h\u1eb3n kh\xf4ng l\u1ea1 g\xec v\u1edbi Pivot Table. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 Pivot Table trong Excel, Pandas h\u1ed7 tr\u1ee3 ta t\u1ed5ng h\u1ee3p, tr\xedch l\u1ecdc, ph\xe2n t\xedch d\u1eef li\u1ec7u d\u1ec5 d\xe0ng v\xe0 nhanh ch\xf3ng v\u1edbi ",(0,r.kt)("inlineCode",{parentName:"p"},"pivot_table()"),". "),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"pivot_table()")," kh\xe1 t\u01b0\u01a1ng \u0111\u1ed3ng v\u1edbi ",(0,r.kt)("inlineCode",{parentName:"p"},"groupby()")," b\u1edfi c\xf9ng theo nguy\xean l\xfd split-apply-combine gi\u1ed1ng nhau, tuy nhi\xean d\u1eef li\u1ec7u s\u1ebd \u0111\u01b0\u1ee3c ph\xe2n t\xedch v\xe0 t\u1ed5ng h\u1ee3p d\u01b0\u1edbi v\u1edbi ",(0,r.kt)("inlineCode",{parentName:"p"},"pivot_table()")," \u0111a chi\u1ec1u (mulitdimensional) ch\u1ee9 kh\xf4ng ph\u1ea3i l\xe0 m\u1ed9t chi\u1ec1u nh\u01b0 ",(0,r.kt)("inlineCode",{parentName:"p"},"groupby()"),"."),(0,r.kt)("p",null,"M\u1ed9t s\u1ed1 tham s\u1ed1 c\u1ea7n l\u01b0u \xfd:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"data: DataFrame"),(0,r.kt)("li",{parentName:"ul"},"values (optional): c\u1ed9t \u0111\u1ec3 t\u1ed5ng h\u1ee3p"),(0,r.kt)("li",{parentName:"ul"},"index: c\u1ed9t, Group ho\u1eb7c m\u1ea3ng. N\u1ebfu m\u1ea3ng \u0111\u01b0\u1ee3c truy\u1ec1n v\xe0o th\xec ph\u1ea3i c\xf3 \u0111\u1ed9 d\xe0i b\u1eb1ng v\u1edbi d\u1eef li\u1ec7u"),(0,r.kt)("li",{parentName:"ul"},"columns: c\u1ed9t, Group ho\u1eb7c m\u1ea3ng. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 index"),(0,r.kt)("li",{parentName:"ul"},"aggfunc: (default: mean): h\xe0m t\u1ed5ng h\u1ee3p d\u1eef li\u1ec7u"),(0,r.kt)("li",{parentName:"ul"},"fill_value: gi\xe1 tr\u1ecb \u0111\u01b0\u1ee3c \u0111i\u1ec1n v\xe0o c\xe1c \xf4 d\u1eef li\u1ec7u NA (sau khi \u0111\xe3 t\xednh to\xe1n)"),(0,r.kt)("li",{parentName:"ul"},"margins: (bool, default: False). Th\xeam m\u1ed9t c\u1ed9t t\xednh t\u1ea5t c\u1ea3 c\xe1c gi\xe1 tr\u1ecb c\u1ee7a c\xe1c c\u1ed9t c\xf2n l\u1ea1i theo h\xe0m t\u1ed5ng h\u1ee3p"),(0,r.kt)("li",{parentName:"ul"},"margins_name (string, default: 'All'): T\xean c\u1ee7a c\u1ed9t margins"),(0,r.kt)("li",{parentName:"ul"},"dropna: (bool, default: False). B\u1ecf \u0111i c\xe1c h\xe0ng c\xf3 ch\u1ee9a NA"),(0,r.kt)("li",{parentName:"ul"},"observed: (bool, default: False). Ch\u1ec9 \xe1p d\u1ee5ng n\u1ebfu t\u1ea5t c\u1ea3 c\xe1c nh\xf3m d\u1eef li\u1ec7u \u0111\u1ec1u l\xe0 Categoricals.N\u1ebfu l\xe0 True: ch\u1ec9 hi\u1ec3n th\u1ecb c\xe1c gi\xe1 tr\u1ecb quan s\xe1t \u0111\u01b0\u1ee3c cho c\xe1c nh\xf3m ph\xe2n lo\u1ea1i. N\u1ebfu l\xe0 False: hi\u1ec3n th\u1ecb t\u1ea5t c\u1ea3 c\xe1c gi\xe1 tr\u1ecb cho c\xe1c nh\xf3m ph\xe2n lo\u1ea1i.")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-t\xednh-trung-b\xecnh-s\u1ed1-ti\u1ec1n-m\u1ed7i-gi\u1edbi-t\xednh-tr\u1ea3-khi-\u0103n-t\u1ea1i-nh\xe0-h\xe0ng-theo-th\u1ed1ng-k\xea-trong-tips_df-1"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": T\xednh trung b\xecnh s\u1ed1 ti\u1ec1n m\u1ed7i gi\u1edbi t\xednh tr\u1ea3 khi \u0103n t\u1ea1i nh\xe0 h\xe0ng theo th\u1ed1ng k\xea trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.pivot_table(values='total_bill_tip', index='sex', aggfunc='mean')\n")),(0,r.kt)("h4",{id:"th\u1ef1c-h\xe0nh-t\xednh-t\u1ed5ng-s\u1ed1-ti\u1ec1n-nh\xe0-h\xe0ng-thu-\u0111\u01b0\u1ee3c-kh\xf4ng-k\u1ec3-tips-c\xe1c-ng\xe0y-trong-tu\u1ea7n-theo-b\u1eefa-\u0103n-\u0111\u01b0\u1ee3c-th\u1ed1ng-k\xea-trong-tips_df"},(0,r.kt)("strong",{parentName:"h4"},"Th\u1ef1c h\xe0nh"),": T\xednh t\u1ed5ng s\u1ed1 ti\u1ec1n nh\xe0 h\xe0ng thu \u0111\u01b0\u1ee3c kh\xf4ng k\u1ec3 tips c\xe1c ng\xe0y trong tu\u1ea7n theo b\u1eefa \u0103n \u0111\u01b0\u1ee3c th\u1ed1ng k\xea trong ",(0,r.kt)("inlineCode",{parentName:"h4"},"tips_df"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"tips_df.pivot_table(values='total_bill', index='day', columns='time',aggfunc='sum')\n")),(0,r.kt)("h3",{id:"4-h\u1ee3p-nh\u1ea5t-d\u1eef-li\u1ec7u-merge-concat"},"4. H\u1ee3p nh\u1ea5t d\u1eef li\u1ec7u (Merge, Concat)"),(0,r.kt)("h4",{id:"41-merge"},"4.1 Merge"),(0,r.kt)("p",null,"Pandas c\xf3 \u0111\u1ea7y \u0111\u1ee7 t\xednh n\u0103ng, hi\u1ec7u su\u1ea5t cao trong ho\u1ea1t \u0111\u1ed9ng in-memory join r\u1ea5t gi\u1ed1ng v\u1edbi SQL th\xf4ng qua h\xe0m ",(0,r.kt)("inlineCode",{parentName:"p"},"merge()"),". D\u01b0\u1edbi \u0111\xe2y l\xe0 1 s\u1ed1 so s\xe1nh gi\u1eefa ph\u01b0\u01a1ng ph\xe1p s\u1eed d\u1ee5ng trong Pandas v\xe0 trong SQL v\xe0 h\xecnh \u1ea3nh minh ho\u1ea1 \u0111\u1ec3 c\xf3 th\u1ec3 th\u1ea5y r\xf5 s\u1ef1 t\u01b0\u01a1ng \u0111\u1ed3ng n\xe0y."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Merge methods"),(0,r.kt)("th",{parentName:"tr",align:null},"SQL Join Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Meaning"),(0,r.kt)("th",{parentName:"tr",align:null},"_merge"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"left"),(0,r.kt)("td",{parentName:"tr",align:null},"LEFT OUTER JOIN"),(0,r.kt)("td",{parentName:"tr",align:null},"Ch\u1ec9 s\u1eed d\u1ee5ng keys b\xean tr\xe1i"),(0,r.kt)("td",{parentName:"tr",align:null},"left_only")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"right"),(0,r.kt)("td",{parentName:"tr",align:null},"RIGHT OUTER JOIN"),(0,r.kt)("td",{parentName:"tr",align:null},"Ch\u1ec9 s\u1eed d\u1ee5ng keys b\xean ph\u1ea3i"),(0,r.kt)("td",{parentName:"tr",align:null},"right_only")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"outer"),(0,r.kt)("td",{parentName:"tr",align:null},"FULL OUTER JOIN"),(0,r.kt)("td",{parentName:"tr",align:null},"S\u1eed d\u1ee5ng keys c\u1ee7a c\u1ea3 2 dataframes"),(0,r.kt)("td",{parentName:"tr",align:null},"both")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"inner"),(0,r.kt)("td",{parentName:"tr",align:null},"INNER JOIN"),(0,r.kt)("td",{parentName:"tr",align:null},"Ch\u1ec9 s\u1eed d\u1ee5ng keys giao nhau c\u1ee7a 2 dataframes"),(0,r.kt)("td",{parentName:"tr",align:null},"both")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://lh3.googleusercontent.com/-n76c6dtr5sw/YBO5d-3PzGI/AAAAAAAAAh8/xiT6YIzePLEXArb8uU1f1vgg8JRXYeg8ACLcBGAsYHQ/image.png",alt:null})," "),(0,r.kt)("p",null,"D\u01b0\u1edbi \u0111\xe2y l\xe0 1 s\u1ed1 v\xed d\u1ee5 gi\xfap b\u1ea1n l\xe0m quen v\u1edbi c\xe1ch s\u1eed d\u1ee5ng h\xe0m v\u1edbi c\xe1c tham s\u1ed1 tr\xean."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"left = tips_df.head(6)[['total_bill','tip']].reset_index()\nright = tips_df.loc[4:8][['tip','sex']].reset_index()\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"left.merge(right, on=['index','tip'], how='left')\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"left.merge(right, on=['index','tip'], how='right')\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"left.merge(right, on=['index','tip'], how='inner')\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"left.merge(right, on=['index','tip'], how='outer')\n")),(0,r.kt)("h4",{id:"42-concat"},"4.2 Concat"),(0,r.kt)("p",null,"Trong th\u1ef1c t\u1ebf, ta c\xf3 th\u1ec3 l\xe0m vi\u1ec7c v\u1edbi c\xe1c d\u1eef li\u1ec7u c\xf3 c\u1ea5u tr\xfac c\xf9ng 1 format (bao g\u1ed3m c\xe1c c\u1ed9t t\u01b0\u01a1ng \u0111\u1ed3ng nhau) nh\u01b0ng \u0111\u01b0\u1ee3c chia nh\u1ecf th\xe0nh c\xe1c file kh\xe1c nhau. \u0110\u1ec3 c\xf3 th\u1ec3 thu\u1eadn l\u1ee3i \u0111\xe1nh gi\xe1 \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u 1 c\xe1ch t\u1ed5ng quan nh\u1ea5t, ta c\u1ea7n n\u1ed1i c\xe1c d\u1eef li\u1ec7u c\xf3 c\u1ea5u tr\xfac n\xe0y v\u1edbi nhau v\xe0 Pandas h\u1ed7 tr\u1ee3 ta \u0111\u1eafc l\u1ef1c th\xf4ng qua h\xe0m ",(0,r.kt)("inlineCode",{parentName:"p"},"pd.concat()"),". D\u01b0\u1edbi \u0111\xe2y l\xe0 1 v\xed d\u1ee5 v\u1ec1 c\xe1ch th\u1ee9c h\xe0m ho\u1ea1t \u0111\u1ed9ng. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"pd.concat([tips_df.head(3),tips_df.tail(3), tips_df.sample(3)[['total_bill','tip','sex']]])\n")),(0,r.kt)("p",null,"Trong b\xe0i sau, ch\xfang ta s\u1ebd c\xf9ng nhau t\xecm hi\u1ec3u c\xe1ch tr\u1ef1c quan ho\xe1 d\u1eef li\u1ec7u th\xf4ng qua 1 s\u1ed1 th\u01b0 vi\u1ec7n ph\u1ed5 bi\u1ebfn nh\u01b0 Matplotlib, Seaborn."))}m.isMDXComponent=!0}}]);